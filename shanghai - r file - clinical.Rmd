---
title: "Untitled"
output: html_document
date: "2026-01-01"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library(ggplot2)

data <- data.frame(Metabolite = c("TML", "IS", "PAGln", "DCA", "TMAO"), Weight = c(0.29, 0.24, 0.23, 0.13, 0.11))
```

```{r}
#sort the data by weight for a cleaner look 
data$Metabolite <- factor(data$Metabolite, levels = data$Metabolite[order(data$Weight)])
```

```{r}
ggplot(data, aes(x = Metabolite, y = Weight)) + 
  geom_bar(stat = "identity", fill = "steelblue", width = 0.7) + 
  coord_flip() + #Makes the bars horizontal 
  theme_minimal()+ 
  labs(title = "Mixture Weights", subtitle = "Total Mixture HR: 1.92(1.48,2.32)", x = "", y ="Weights") + 
  geom_text(aes(label = Weight), hjust = -0.2, size = 4) +#Adds values to the end of bars
  ylim(0,0.35) #Adds a bit of space for the labels
```

```{r}
library(ggplot2)
# create the dataset from the second image 
data2 <- data.frame(Variable = c("Mean area", "Max thickness", "Min depth", "Max arc", "Mean arc", "Max length", "Max volume", "Total volume", "Max index", "Mean index"), Weight = c(0.15, 0.082, 0.48, 0.18, 0.13, 0.19, 0.37, 0.063, 0.215, 0.14))

# reorder variable by weight so the largest bar is at the top 
data2$Variable <- factor(data2$Variable, levels = data2$Variable[order(data2$Weight)])

#Create the plot
ggplot(data2, aes(x = Variable, y = Weight)) + 
  geom_bar(stat = "identity", fill = "steelblue", width = 0.7) + 
  coord_flip() + 
  theme_minimal() + 
  labs(title = "Mixture Weights (Table 1)", subtitle = "Mixture HR: 1.68 (95% CI: 1.25, 2.13)", x = "", y = "Contribution Weight") + 
  geom_text(aes(label = sprintf("%.3f", Weight)), hjust = -0.2, size = 3.5) + 
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) #Adds room for labels
```

```{r}
library(ggplot2)

# 1. Create the dataset from Table 1
data_table1 <- data.frame(Variable = c("Min depth", "Max volume", "Max index", "Max length", "Max arc", "Mean area", "Mean index", "Mean arc", "Max thickness", "Total volume"), Weight = c(-0.48, -0.37, 0.215, 0.19, 0.18, -0.15, 0.14, 0.13, 0.082, 0.063))

# 2. Reorder for the plot 
data_table1$Variable <- factor(data_table1$Variable, levels = rev(data_table1$Variable))

# 3. Create the plot 
ggplot(data_table1, aes(x = Variable, y = Weight)) + 
  geom_bar(stat = "identity", fill = "black", width = 0.7) + 
  coord_flip(clip = "off") + # 'clip=off' allows text to sit outside the plot area
  # Expand x-axis (y-axis after flip) from -0.8 to 0.8 as requested
  scale_y_continuous(
    limits = c(-0.8,0.8), 
    breaks = seq(-0.75, 0.75, 0.25), 
    labels = c("0.75", "0.50", "0.25", "0", "0.25", "0.50", "0.75")
  ) + 
  theme_bw() +
  theme(
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(), 
    axis.title.x = element_blank(), #removing default title to use manual labels 
    plot.title = element_text(hjust = 0.5, face = "bold"),
  # increase the bottom margin to make room for the labels 
    plot.margin = margin(t = 10, r = 10, b = 50, l = 10)
  ) +
  geom_hline(yintercept = 0, color = "black") + 
  # labels positioned at -0.5 and 0.5 on the scale 
  # x = 0 is slightly below the last bar on the axis 
  annotate("text", x = 0.4, y = -0.4, label = "Negative weight", 
           vjust = 4, fontface = "bold", size = 4) +
  annotate("text", x =0.4, y = 0.4, label = "Positive weight", 
           vjust=4, fontface = "bold", size = 4) +
  labs(title = "Mixture Weights", subtitle = "Mixture HR: 1.68 (1.25, 2.13)")
```

```{r}
library(ggplot2)

# 1. Create the dataset from Table 2
data_table2 <- data.frame(
  Metabolite = c("TML", "IS", "PAGln", "DCA", "TMAO"),
  Weight = c(0.29, 0.24, 0.23, 0.13, 0.11)
)

# 2. Reorder for the plot (highest weight at top)
data_table2$Metabolite <- factor(data_table2$Metabolite, levels = rev(data_table2$Metabolite))

# 3. Create the plot with your specific requirements 
ggplot(data_table2, aes(x = Metabolite, y = Weight)) +
  geom_bar(stat = "identity", fill = "black", width = 0.6) + 
  coord_flip(clip = "off") + 
  scale_y_continuous(
    limits = c(-0.8,0.8), 
    breaks = seq(-0.75, 0.75, 0.25), 
    labels = c("0.75", "0.50", "0.25", "0", "0.25", "0.50", "0.75")
  )+
  theme_bw() +
  theme(
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_text(face = "bold"), 
    plot.title = element_text(hjust = 0.5, face = "bold"), 
    plot.margin = margin(10, 10, 30, 10)
  ) +
  #Room for labels
  geom_hline(yintercept = 0, color = "black") + 
  # labels move 'upward' using vjust = 4
  annotate("text", x = 0.4, y = -0.4, label = "Negative weight", 
           vjust = 4, fontface = "bold", size = 4) + 
  annotate("text", x = 0.4, y = 0.4, label = "Positive weight",
           vjust = 4, fontface = "bold", size = 4) +
  labs(title = "Mixture Weights", subtitle = "Mixture HR: 1.92 (1.48, 2.32)", x = "Variable")

```


```{r}
library(ggplot2)

# 1. Create the dataset from Table 1
data_table1 <- data.frame(Variable = c("Mean area", "Max thickness", "Min depth", "Max arc", "Mean arc", "Max length", "Max volume", "Total volume", "Max index", "Mean index"), Weight = c(-0.15, 0.082, -0.48, 0.18, 0.13, 0.19, -0.37, 0.063, 0.215, 0.14))

# 2. Sort the data to put negative weights on top

#we sort by weight in descending order (largest --> smallest)

# level 1 will be the largest positive (bottom of the chart)
#level N will be the smallest/most negative (top of chat)

data_table1 <- data_table1[order(data_table1$Weight, decreasing = TRUE),]

data_table1$Variable <- factor(data_table1$Variable, levels = data_table1$Variable)

# 3. Create the plot 
ggplot(data_table1, aes(x = Variable, y = Weight)) + 
  geom_bar(stat = "identity", fill = "black", width = 0.7) + 
  coord_flip(clip = "off") + # 'clip=off' allows text to sit outside the plot area
  # Expand x-axis (y-axis after flip) from -0.8 to 0.8 as requested
  scale_y_continuous(
    limits = c(-0.8,0.8), 
    breaks = seq(-0.75, 0.75, 0.25), 
    labels = c("0.75", "0.50", "0.25", "0", "0.25", "0.50", "0.75")
  ) + 
  theme_bw() +
  theme(
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(), 
    axis.title.x = element_blank(), #removing default title to use manual labels 
    plot.title = element_text(hjust = 0.5, face = "bold"),
  # increase the bottom margin to make room for the labels 
    plot.margin = margin(t = 10, r = 10, b = 50, l = 10)
  ) +
  geom_hline(yintercept = 0, color = "black") + 
  # labels positioned at -0.5 and 0.5 on the scale 
  # x = 0 is slightly below the last bar on the axis 
  annotate("text", x = 0.4, y = -0.4, label = "Negative weight", 
           vjust = 4, fontface = "bold", size = 4) +
  annotate("text", x =0.4, y = 0.4, label = "Positive weight", 
           vjust=4, fontface = "bold", size = 4) +
  labs(title = "Mixture Weights", subtitle = "Mixture HR: 1.68 (1.25, 2.13)")
```


```{r}
library(ggplot2)

# 1. Data Setup with specific negative values to group them at the top
data_table1 <- data.frame(
  Variable = c("Mean area", "Max thickness", "Min depth", "Max arc", "Mean arc", "Max length", "Max volume", "Total volume", "Max index", "Mean index"), 
  Weight = c(-0.15, 0.082, -0.48, 0.18, 0.13, 0.19, -0.37, 0.063, 0.215, 0.14)
  )

# 2. Add a 'Group' column to handle colors correctly

# This is the "Code to be True" you asked for


data_table1$Group <- ifelse(data_table1$Weight<0, "Negative", "Positive")

# 3. Sort the data: Negatives (smallest) will be at the end of the factor levels because we use coord_flip, the end of the levels appears at the TOP of the chart

data_table1 <- data_table1[order(data_table1$Weight, decreasing = TRUE), ]

data_table1$Variable <- factor(data_table1$Variable, levels = data_table1$Variable)

# 4. Create the plot 
ggplot(data_table1, aes(x = Variable, y = Weight, fill = Group)) + 
  geom_bar(stat = "identity", width = 0.7, color = "black") + #'color is the bar outline
  coord_flip(clip = "off") + # 'clip=off' allows text to sit outside the plot area
  # Set limits to 0.9 to increase the distance to the end of the x-axis
  scale_y_continuous(
    limits = c(-0.9, 0.9), 
    breaks = seq(-0.75, 0.75, 0.25), 
    labels = c("0.75", "0.50", "0.25", "0", "0.25", "0.50", "0.75")
  ) + 
  # explicitly map the colors to the Group names
  scale_fill_manual(values = c("Negative" = "grey70", "Positive" = "black")) +
  theme_bw() +
  theme(
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(), 
    axis.title.x = element_blank(), #removing default title to use manual labels 
    legend.position = "none", # Hide the color legend
    plot.title = element_text(hjust = 0.5, face = "bold"),
  # increase the bottom margin to make room for the labels 
    plot.margin = margin(10, 20, 50, 10)
  ) +
  geom_hline(yintercept = 0, color = "black") + 
  # labels positioned at -0.5 and 0.5 on the scale 
  # x = 0 is slightly below the last bar on the axis 
  annotate("text", x = 0.4, y = -0.5, label = "Negative weight", 
           vjust = 3, fontface = "bold", size = 4) +
  annotate("text", x =0.4, y = 0.5, label = "Positive weight", 
           vjust= 3, fontface = "bold", size = 4) +
  labs(title = "Mixture Weights", subtitle = "Mixture HR: 1.68 (1.25, 2.13)")
```

```{r}
library(ggplot2)

# 1. create the dataset from Table 2 
data_table2 <- data.frame(Metabolite = c("TML", "IS", "PAGln","DCA", "TMAO"),
                          Weight = c(0.29, 0.24, 0.23, 0.13, 0.11))

# 2. Add 'Group' column for coloring - Use TRUE in ALL Caps
data_table2$Group <- ifelse(data_table2$Weight < 0, "Negative", "Positive")

# 3. Sort: negatives will be at the end of the levels (Top of chart)
data_table2 <- data_table2[order(data_table2$Weight, decreasing = TRUE), ]

data_table2$Metabolite <- factor(data_table2$Metabolite, levels = data_table2$Metabolite)

# 4. Create the Plot
ggplot(data_table2, aes(x = Metabolite, y = Weight, fill = Group)) + 
  #Width = 0.9 makes the bars wider and the gap smaller 
  geom_bar(stat = "identity", width = 0.9, color = "black") + 
  coord_flip(clip = "off") + 
  #limits = c(-0.9, 0.9) ensures distance at the ends of the axis
  scale_y_continuous(
    limits = c(-0.9, 0.9), 
    breaks = seq(-0.75, 0.75, 0.25), 
    labels = c("0.75", "0.50", "0.25", "0", "0.25", "0.50", "0.75")
  ) + 
  scale_fill_manual(values = c("Negative" = "grey70", "Positive" = "black")) + 
  theme_bw() + 
  theme(
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(), 
    axis.title.x = element_blank(), 
    legend.position = "none", 
    plot.title = element_text(hjust = 0.5, face = "bold"), 
    plot.margin = margin(10, 20, 50, 10)
  ) + 
  geom_hline(yintercept = 0, color = "black") + 
  # Labels positioned upward (vjust = 3.5)
  annotate("text", x = 0.4, y = -0.5, label = "Negative weight", 
           vjust = 3.5, fontface = "bold", size = 4) + 
  annotate("text", x = 0.4, y = 0.5, label = "Positive weight", 
           vjust = 3.5, fontface = "bold", size = 4) + 
  labs(
    title = "Mixture Weights", 
    subtitle = "Mixture HR: 1.92 (1.48, 2.32)", #From Table 2
    x = "Variable"
  )
```

```{r}
library(ggplot2)

# 1. Data Setup with specific negative values to group them at the top
data_table1 <- data.frame(
  Variable = c("Mean area", "Max thickness", "Min depth", "Max arc", "Mean arc", "Max length", "Max volume", "Total volume", "Max index", "Mean index"), 
  Weight = c(-0.15, 0.082, -0.48, 0.18, 0.13, 0.19, -0.37, 0.063, 0.215, 0.14)
  )

# 2. Add a 'Group' column to handle colors correctly

# This is the "Code to be True" you asked for


data_table1$Group <- ifelse(data_table1$Weight<0, "Negative", "Positive")

# 3. Sort the data: Negatives (smallest) will be at the end of the factor levels because we use coord_flip, the end of the levels appears at the TOP of the chart

data_table1 <- data_table1[order(data_table1$Weight, decreasing = TRUE), ]

data_table1$Variable <- factor(data_table1$Variable, levels = data_table1$Variable)

# 4. Create the plot 
ggplot(data_table1, aes(x = Variable, y = Weight, fill = Group)) + 
  geom_bar(stat = "identity", width = 0.7, color = "black") + #'color is the bar outline
  coord_flip(clip = "off") + # 'clip=off' allows text to sit outside the plot area
  # Set limits to 0.9 to increase the distance to the end of the x-axis
  scale_y_continuous(
    limits = c(-0.9, 0.9), 
    breaks = seq(-0.75, 0.75, 0.25), 
    labels = c("0.75", "0.50", "0.25", "", "0.25", "0.50", "0.75")
  ) + 
  # explicitly map the colors to the Group names
  scale_fill_manual(values = c("Negative" = "grey70", "Positive" = "black")) +
  theme_bw() +
  theme(
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(), 
    axis.title.x = element_blank(), #removing default title to use manual labels 
    legend.position = "none", # Hide the color legend
    plot.title = element_text(hjust = 0.5, face = "bold"),
  # increase the bottom margin to make room for the labels 
    plot.margin = margin(10, 20, 50, 10)
  ) +
  geom_hline(yintercept = 0, color = "black") + 
  # labels positioned at -0.5 and 0.5 on the scale 
  # x = 0 is slightly below the last bar on the axis 
  annotate("text", x = 0.4, y = -0.5, label = "Negative weight", 
           vjust = 3, fontface = "bold", size = 4) +
  annotate("text", x =0.4, y = 0.5, label = "Positive weight", 
           vjust= 3, fontface = "bold", size = 4) +
  labs(title = "Mixture Weights", subtitle = "Mixture HR: 1.68 (1.25, 2.13)")
```


```{r}
ggsave("Table1.png", 
       width = 7,
       height = 5, 
       units = "in",
       dpi = 300)
```


```{r}
library(ggplot2)

# 1. create the dataset from Table 2 
data_table2 <- data.frame(Metabolite = c("TML", "IS", "PAGln","DCA", "TMAO"),
                          Weight = c(0.29, 0.24, 0.23, 0.13, 0.11))

# 2. Add 'Group' column for coloring - Use TRUE in ALL Caps
data_table2$Group <- ifelse(data_table2$Weight < 0, "Negative", "Positive")

# 3. Sort: negatives will be at the end of the levels (Top of chart)
data_table2 <- data_table2[order(data_table2$Weight, decreasing = TRUE), ]

data_table2$Metabolite <- factor(data_table2$Metabolite, levels = data_table2$Metabolite)

# 4. Create the Plot
ggplot(data_table2, aes(x = Metabolite, y = Weight, fill = Group)) + 
  #Width = 0.9 makes the bars wider and the gap smaller 
  geom_bar(stat = "identity", width = 0.9, color = "black") + 
  coord_flip(clip = "off") + 
  #limits = c(-0.9, 0.9) ensures distance at the ends of the axis
  scale_y_continuous(
    limits = c(-0.9, 0.9), 
    breaks = seq(-0.75, 0.75, 0.25), 
    labels = c("0.75", "0.50", "0.25", "", "0.25", "0.50", "0.75")
  ) + 
  scale_fill_manual(values = c("Negative" = "grey70", "Positive" = "black")) + 
  theme_bw() + 
  theme(
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(), 
    axis.title.x = element_blank(), 
    legend.position = "none", 
    plot.title = element_text(hjust = 0.5, face = "bold"), 
    plot.margin = margin(10, 20, 50, 10)
  ) + 
  geom_hline(yintercept = 0, color = "black") + 
  # Labels positioned upward (vjust = 3.5)
  annotate("text", x = 0.4, y = -0.5, label = "Negative weight", 
           vjust = 3.5, fontface = "bold", size = 4) + 
  annotate("text", x = 0.4, y = 0.5, label = "Positive weight", 
           vjust = 3.5, fontface = "bold", size = 4) + 
  labs(
    title = "Mixture Weights", 
    subtitle = "Mixture HR: 1.92 (1.48, 2.32)", #From Table 2
    x = "Variable"
  )
```

```{r}
ggsave("Table2_Metabolites.png", 
       width = 7,
       height = 5, 
       units = "in",
       dpi = 300)
```


```{r}
ggsave("Table2_metabolites.pdf", 
       width = 7, 
       height = 5)

```



```{r}
library(ggplot2)
#table 1

data_table1 <- data.frame(
  Variable = c("Mean area", "Max thickness", "Min depth", "Max arc", "Mean arc", "Max length", "Max volume", "Total volume", "Max index", "Mean index"), 
  Weight = c(-0.15, 0.082, -0.48, 0.18, 0.13, 0.19, -0.37, 0.063, 0.215, 0.14)
  )

data_table1$Group <- ifelse(data_table1$Weight<0, "Negative", "Positive")

#sort the data: largest weights first 
# this ensures the sorting logic is clear before creating the plot
data_table1 <- data_table1[order(data_table1$Weight, decreasing = TRUE), ]

#2. set the factor levels based on this sorted order 
data_table1$Variable <- factor(data_table1 $ Variable, levels = rev(data_table1$Variable))

#3. create the plot
ggplot(data_table1, aes(x = Variable, y = Weight, fill = Group)) + 
  geom_bar(stat = "identity", width = 0.95, color = "black") + 
  coord_flip(clip = "off") +
  scale_y_continuous(
    limits = c(-1.15, 1.15), 
    breaks = seq(-0.75,0.75,0.25), 
    labels = c("0.75", "0.50", "0.25", "", "0.25", "0.50", "0.75")
  )+
  #ensure manual scale matches group names 
  scale_fill_manual(values = c("Negative" = "grey70", "Positive" = "black"))+
  theme_bw()+
  theme(
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(),
    axis.title.x = element_blank(),
    legend.position = "none"
  )+
 labs(
    title = "Mixture Weights", 
    subtitle = "Mixture HR: 1.92 (1.48, 2.32)", #From Table 2
    x = "Variable"
```


```{r}
library(ggplot2)

# 1. create the dataset from Table 2 
data_table2 <- data.frame(Metabolite = c("TML", "IS", "PAGln","DCA", "TMAO"),
                          Weight = c(0.29, 0.24, 0.23, 0.13, 0.11))

# 2. Add 'Group' column for coloring - Use TRUE in ALL Caps
data_table2$Group <- ifelse(data_table2$Weight < 0, "Negative", "Positive")

# sort the data by Weight descending 
# note: use "decreasing = TRUE" in all caps to avoid erros 

data_table2 <- data_table2[order(data_table2$Weight, decreasing = TRUE), ]

data_table2$Metabolite <- factor(data_table2$Metabolite, levels = rev(data_table2$Metabolite))

#3. create the plot with wider bars 
ggplot(data_table2, aes(x = Metabolite, y = Weight, fill=Group)) + 
  geom_bar(stat = "identity", width = 0.95, color = "black") + 
  coord_flip(clip = "off") + 
  scale_y_continuous(
    limits = c(-1.15, 1.15), 
    breaks = seq(-0.75,0.75,0.25), 
    labels = c("0.75", "0.50", "0.25", "", "0.25", "0.50", "0.75")
  ) + 
  scale_fill_manual(values = c("Negative" = "grey70", "Positive" = "black")) + 
  theme_bw() + 
  theme(
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(),
    axis.title.x = element_blank(), 
    legend.position = "none"
  ) +
    geom_hline(yintercept = 0, color = "black") + 
  # Labels positioned upward (vjust = 3.5)
  annotate("text", x = -0.5, y = 0.45, label = "Negative weight", 
           vjust = 3.5, fontface = "bold", size = 4) + 
  annotate("text", x = 0.5, y = 0.45, label = "Positive weight", 
           vjust = 3.5, fontface = "bold", size = 4) +
    labs(
    title = "Mixture Weights", 
    subtitle = "Mixture HR: 1.92 (1.48, 2.32)", #From Table 2
    x = "Variable"
  )
ggsave("plot2.png", 
       width = 7,
       height = 5, 
       units = "in",
       dpi = 300)
```

```{r}
library(ggplot2)

# 1. create the dataset with correct negative values 
data_table1 <- data.frame(
  Variable = c("Mean area", "Max thickness", "Min depth", "Max arc", "Mean arc", "Max length", "Max volume", "Total volume", "Max index", "Mean index"), 
  Weight = c(-0.15, 0.082, -0.48, 0.18, 0.13, 0.19, -0.37, 0.063, 0.215, 0.14)
)

# 2. Define Groups and Sort 
# Use TRUE in all caps to avoid "object not found"
data_table1$Group <- ifelse(data_table1$Weight < 0, "Negative", "Positive")

# Sort: Positives first (smallest to largest), then Negatives at the end 
# This forces Negatives to the TOP when using coord_flip
data_table1 <- data_table1[order(data_table1$Group == "Negative", data_table1$Weight), ]

data_table1$Variable <- factor(data_table1$Variable, levels = data_table1$Variable)

# 3. Create the Plot 
plot1 <- ggplot(data_table1, aes(x = Variable, y = Weight, fill = Group)) + 
  geom_bar(stat = "identity", width = 0.95, color = "black") + #Wider bars 
  coord_flip(clip = "off") + 
  scale_y_continuous( 
    limits = c(-1.15, 1.15), #Extra distance at ends
    breaks = seq(-0.75, 0.75, 0.25), 
    labels = c("0.75", "0.50", "0.25", "", "0.25", "0.50", "0.75") #removed 0
    ) + 
  scale_fill_manual(values = c("Negative" = "grey70", "Positive" = "black")) + 
  theme_bw() + 
  theme(
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(), 
    axis.title.x = element_blank(), 
    legend.position = "none", 
    plot.title = element_text(hjust = 0.5, face = "bold"), 
    plot.margin = margin(10, 20, 50, 10)
  ) + 
  geom_hline(yintercept = 0, color = "black") + 
  annotate("text", x = 0.5, y = -0.4, label = "Negative weight", vjust = 4, fontface = "bold") + 
  annotate("text", x = 0.5, y = 0.4, label = "Positive weight", vjust = 4, fontface = "bold") + 
  labs(title = "Mixture Weights", subtitle = "Mixture HR: 1.68 (1.25, 2.13)")

print(plot1)

```

```{r}
library(ggplot2)
# 1. create the dataset
data_table1<-data.frame(
  Variable = c("Mean area", "Max thickness", "Min depth", "Max arc", "Mean arc", "Max length", "Max volume", "Total volume", "Max index", "Mean index"), 
  Weight = c(-0.15, 0.082, -0.48, 0.18, 0.13, 0.19, -0.37, 0.063, 0.215, 0.14)
)
# 2. Add Group column (use TRUE in ALL CAPS)
data_table1$Group <- ifelse(data_table1$Weight < 0, "Negative", "Positive")

# 3. Two-Step Sorting Logic: 
# A: Sort by Group (Positives first, Negatives last)
# B: Sort within each group by absolute weight (Smallest to Largest)
# Since coord_flip() plots from bottom-up, this puts Largest Negatives at the VERY TOP
data_table1 <- data_table1[order(data_table1$Group == "Negative", abs(data_table1$Weight)), ]

data_table1$Variable <- factor(data_table1$Variable, levels = data_table1$Variable)

# 4. Create the Plot - Fixing the missing 'x' aesthetic error
plot1 <- ggplot(data_table1, aes(x = Variable, y = Weight, fill = Group)) + 
  geom_bar(stat = "identity", width = 0.85, color = "black") + 
  coord_flip(clip = "off") + 
  scale_y_continuous(
    limits = c(-0.9, 0.9), 
    breaks = seq(-0.75, 0.75, 0.25), 
    #removes the '0' label
    labels = c("0.75", "0.50", "0.25", "", "0.25", "0.50", "0.75")
  ) + 
  #Explicitly map colors: Grey for Negative, Black for Positive
  scale_fill_manual(values = c("Negative" = "grey70", "Positive" = "black")) + 
  theme_bw() + 
  theme(
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(), 
    axis.title.x = element_blank(), 
    legend.position = "none", 
    plot.title = element_text(hjust = 0.5, face = "bold"), 
    plot.margin = margin(1, 1, 1, 1)
  ) + 
  geom_hline(yintercept = 0, color = "black") + 
  annotate("text", x = 0.5, y = -0.4, label = "Negative weight", 
           vjust = 4, fontface = "bold", size = 4) + 
  annotate("text", x = 0.5, y = -0.4, label = "Negative weight", 
           vjust = 4, fontface = "bold", size = 4) + 
  labs(title = "Mixture Weights", subtitle = "Mixture HR:1.68 (1.25, 2.13)") 

print(plot1)
ggsave("plot.png", 
       width = 7,
       height = 5, 
       units = "in",
       dpi = 300)
```

```{r}
library(ggplot2)

# 1. create the dataset from Table 2 
data_table2 <- data.frame(Metabolite = c("TML", "IS", "PAGln","DCA", "TMAO"),
                          Weight = c(0.29, 0.24, 0.23, 0.13, 0.11))

# 2. Add 'Group' column for coloring - Use TRUE in ALL Caps
data_table2$Group <- ifelse(data_table2$Weight < 0, "Negative", "Positive")

# sort the data by Weight descending 
# note: use "decreasing = TRUE" in all caps to avoid erros 

data_table2 <- data_table2[order(data_table2$Weight, decreasing = TRUE), ]

data_table2$Metabolite <- factor(data_table2$Metabolite, levels = rev(data_table2$Metabolite))

#3. create the plot with wider bars 
ggplot(data_table2, aes(x = Metabolite, y = Weight, fill=Group)) + 
  geom_bar(stat = "identity", width = 0.95, color = "black") + 
  coord_flip(clip = "off") + 
  scale_y_continuous(
    limits = c(-0.9, 0.9), 
    breaks = seq(-0.75,0.75,0.25), 
    labels = c("0.75", "0.50", "0.25", "", "0.25", "0.50", "0.75")
  ) + 
  scale_fill_manual(values = c("Negative" = "grey70", "Positive" = "black")) + 
  theme_bw()  + 
  theme(
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(), 
    axis.title.x = element_blank(), 
    legend.position = "none", 
    plot.title = element_text(hjust = 0.5, face = "bold"), 
    plot.margin = margin(10, 20, 50, 10)
  ) + 
  geom_hline(yintercept = 0, color = "black") + 
  # Labels positioned upward (vjust = 3.5)
  annotate("text", x = 0.4, y = -0.5, label = "Negative weight", 
           vjust = 3.5, fontface = "bold", size = 4) + 
  annotate("text", x = 0.4, y = 0.5, label = "Positive weight", 
           vjust = 3.5, fontface = "bold", size = 4) + 
  labs(
    title = "Mixture Weights", 
    subtitle = "Mixture HR: 1.92 (1.48, 2.32)", #From Table 2
    x = "Variable"
  )
ggsave("plot2.png", 
       width = 7,
       height = 5, 
       units = "in",
       dpi = 300)
```

```{r}
library(ggplot2)
# 1. create the dataset
data_table1<-data.frame(
  Variable = c("Mean area", "Max thickness", "Min depth", "Max arc", "Mean arc", "Max length", "Max volume", "Total volume", "Max index", "Mean index"), 
  Weight = c(-0.15, 0.082, -0.48, 0.18, 0.13, 0.19, -0.37, 0.063, 0.215, 0.14)
)
# 2. Add Group column (use TRUE in ALL CAPS)
data_table1$Group <- ifelse(data_table1$Weight < 0, "Negative", "Positive")

# 3. Two-Step Sorting Logic: 
# A: Sort by Group (Positives first, Negatives last)
# B: Sort within each group by absolute weight (Smallest to Largest)
# Since coord_flip() plots from bottom-up, this puts Largest Negatives at the VERY TOP
data_table1 <- data_table1[order(data_table1$Group == "Negative", abs(data_table1$Weight)), ]

data_table1$Variable <- factor(data_table1$Variable, levels = data_table1$Variable)

# 4. Create the Plot - Fixing the missing 'x' aesthetic error
plot1 <- ggplot(data_table1, aes(x = Variable, y = Weight, fill = Group)) + 
  geom_bar(stat = "identity", width = 0.85, color = "black") + 
  coord_flip(clip = "off") + 
  scale_y_continuous(
    limits = c(-0.9, 0.9), 
    breaks = seq(-0.75, 0.75, 0.25), 
    #removes the '0' label
    labels = c("0.75", "0.50", "0.25", "", "0.25", "0.50", "0.75")
  ) + 
  #Explicitly map colors: Grey for Negative, Black for Positive
  scale_fill_manual(values = c("Negative" = "grey70", "Positive" = "black")) + 
  theme_bw() + 
  theme(
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(), 
    axis.title.x = element_blank(), 
    legend.position = "none", 
    plot.title = element_text(hjust = 0.5, face = "bold"), 
    plot.margin = margin(10, 20, 50, 10)
  ) + 
  geom_hline(yintercept = 0, color = "black") + 
  annotate("text", x = 0.5, y = -0.4, label = "Negative weight", vjust = 4, fontface = "bold") + 
  annotate("text", x = 0.5, y = 0.4, label = "Positive weight", vjust = 4, fontface = "bold") + 
  labs(title = "Mixture Weights", subtitle = "Mixture HR: 1.68 (1.25, 2.13)")

print(plot1) 

ggsave("plot.png", 
       width = 7,
       height = 5, 
       units = "in",
       dpi = 300)

```


